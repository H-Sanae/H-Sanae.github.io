<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>医药器械法规AI项目 | Tetuka的个人笔记</title><meta name="author" content="Tetuka"><meta name="copyright" content="Tetuka"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="服务器cdh服务器主机: 192.168.8.67端口: 22用户: root密码: zhiyun当前服务器平台版本：CDH6.3http:&#x2F;&#x2F;192.168.8.67:7180&#x2F;cmf&#x2F;login 用户密码都是 admin 12345678910# 创建个人目录mkdir -p &#x2F;zhiyun&#x2F;lijinquancd &#x2F;zhiyun&#x2F;lijinquan# 创建5个功能目录# data - 存放数">
<meta property="og:type" content="article">
<meta property="og:title" content="医药器械法规AI项目">
<meta property="og:url" content="https://h-sanae.github.io/2025/07/31/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%AD%A6%E4%B9%A0/%E9%A1%B9%E7%9B%AE/7.31%20%E5%8C%BB%E8%8D%AF%E5%99%A8%E6%A2%B0%E6%B3%95%E8%A7%84AI%E9%A1%B9%E7%9B%AE%EF%BC%88%E6%95%B0%E6%8D%AE%E5%90%8C%E6%AD%A5%E9%83%A8%E5%88%86%EF%BC%89/index.html">
<meta property="og:site_name" content="Tetuka的个人笔记">
<meta property="og:description" content="服务器cdh服务器主机: 192.168.8.67端口: 22用户: root密码: zhiyun当前服务器平台版本：CDH6.3http:&#x2F;&#x2F;192.168.8.67:7180&#x2F;cmf&#x2F;login 用户密码都是 admin 12345678910# 创建个人目录mkdir -p &#x2F;zhiyun&#x2F;lijinquancd &#x2F;zhiyun&#x2F;lijinquan# 创建5个功能目录# data - 存放数">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://h-sanae.github.io/img/peppapig8.png">
<meta property="article:published_time" content="2025-07-31T02:34:43.979Z">
<meta property="article:modified_time" content="2025-07-31T12:57:51.567Z">
<meta property="article:author" content="Tetuka">
<meta property="article:tag" content="大数据">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://h-sanae.github.io/img/peppapig8.png"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "医药器械法规AI项目",
  "url": "https://h-sanae.github.io/2025/07/31/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%AD%A6%E4%B9%A0/%E9%A1%B9%E7%9B%AE/7.31%20%E5%8C%BB%E8%8D%AF%E5%99%A8%E6%A2%B0%E6%B3%95%E8%A7%84AI%E9%A1%B9%E7%9B%AE%EF%BC%88%E6%95%B0%E6%8D%AE%E5%90%8C%E6%AD%A5%E9%83%A8%E5%88%86%EF%BC%89/",
  "image": "https://h-sanae.github.io/img/peppapig8.png",
  "datePublished": "2025-07-31T02:34:43.979Z",
  "dateModified": "2025-07-31T12:57:51.567Z",
  "author": [
    {
      "@type": "Person",
      "name": "Tetuka",
      "url": "https://h-sanae.github.io/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/dbb.png"><link rel="canonical" href="https://h-sanae.github.io/2025/07/31/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%AD%A6%E4%B9%A0/%E9%A1%B9%E7%9B%AE/7.31%20%E5%8C%BB%E8%8D%AF%E5%99%A8%E6%A2%B0%E6%B3%95%E8%A7%84AI%E9%A1%B9%E7%9B%AE%EF%BC%88%E6%95%B0%E6%8D%AE%E5%90%8C%E6%AD%A5%E9%83%A8%E5%88%86%EF%BC%89/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          const mediaQueryDark = window.matchMedia('(prefers-color-scheme: dark)')
          const mediaQueryLight = window.matchMedia('(prefers-color-scheme: light)')

          if (theme === undefined) {
            if (mediaQueryLight.matches) activateLightMode()
            else if (mediaQueryDark.matches) activateDarkMode()
            else {
              const hour = new Date().getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            mediaQueryDark.addEventListener('change', () => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else {
            theme === 'light' ? activateLightMode() : activateDarkMode()
          }
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '医药器械法规AI项目',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/dbb.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">67</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">33</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">1</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-book"></i><span> 文章</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa-solid fa-flask"></i><span> 实验室</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener" href="http://121.199.61.105/"><i class="fa-fw fas fa-q"></i><span> 豆瓣网开发</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://fuckornot.on.websim.com/"><i class="fa-fw fa fa-trophy"></i><span> 上不上AI评分系统</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://fontawesome.com/icons"><i class="fa-fw fa fa-check-circle"></i><span> font-awesome v6 图标</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/peppapig8.png);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src="/img/dbb.png" alt="Logo"><span class="site-name">Tetuka的个人笔记</span></a><a class="nav-page-title" href="/"><span class="site-name">医药器械法规AI项目</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-book"></i><span> 文章</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fa-solid fa-flask"></i><span> 实验室</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" target="_blank" rel="noopener" href="http://121.199.61.105/"><i class="fa-fw fas fa-q"></i><span> 豆瓣网开发</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://fuckornot.on.websim.com/"><i class="fa-fw fa fa-trophy"></i><span> 上不上AI评分系统</span></a></li><li><a class="site-page child" target="_blank" rel="noopener" href="https://fontawesome.com/icons"><i class="fa-fw fa fa-check-circle"></i><span> font-awesome v6 图标</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">医药器械法规AI项目</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-07-31T02:34:43.979Z" title="发表于 2025-07-31 10:34:43">2025-07-31</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-07-31T12:57:51.567Z" title="更新于 2025-07-31 20:57:51">2025-07-31</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%AC%94%E8%AE%B0/">笔记</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="服务器"><a href="#服务器" class="headerlink" title="服务器"></a>服务器</h1><p><strong>cdh服务器</strong><br>主机: 192.168.8.67<br>端口: 22<br>用户: root<br>密码: zhiyun<br>当前服务器平台版本：CDH6.3<br><a target="_blank" rel="noopener" href="http://192.168.8.67:7180/cmf/login">http://192.168.8.67:7180/cmf/login</a> 用户密码都是 admin</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建个人目录</span></span><br><span class="line"><span class="built_in">mkdir</span> -p /zhiyun/lijinquan</span><br><span class="line"><span class="built_in">cd</span> /zhiyun/lijinquan</span><br><span class="line"><span class="comment"># 创建5个功能目录</span></span><br><span class="line"><span class="comment"># data - 存放数据文件</span></span><br><span class="line"><span class="comment"># jobs - 存放datax的配置文件</span></span><br><span class="line"><span class="comment"># sql - sql脚本</span></span><br><span class="line"><span class="comment"># shell - shell脚本</span></span><br><span class="line"><span class="comment"># python - python脚本</span></span><br><span class="line"><span class="built_in">mkdir</span> data <span class="built_in">jobs</span> sql shell python</span><br></pre></td></tr></table></figure>

<p><strong>数据库</strong><br>主机：192.168.8.8<br>数据库：jd<br>密码：123456</p>
<h1 id="配置文件编写"><a href="#配置文件编写" class="headerlink" title="配置文件编写"></a>配置文件编写</h1><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;job&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span>  <span class="comment">// DataX的核心任务配置，一个job代表一次数据同步任务</span></span><br><span class="line">        <span class="attr">&quot;setting&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span>  <span class="comment">// 任务全局设置（性能控制、错误处理等）</span></span><br><span class="line">            <span class="attr">&quot;speed&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span>  <span class="comment">// 速度控制配置（并行度/吞吐量限制）</span></span><br><span class="line">                <span class="attr">&quot;channel&quot;</span><span class="punctuation">:</span> <span class="number">3</span>  <span class="comment">// 并行通道数：设置为3表示同时启动3个线程并行读取和写入数据，用于控制同步速度（数值越大吞吐量越高，需根据源库和目标存储性能调整）</span></span><br><span class="line">            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;errorLimit&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span>  <span class="comment">// 错误容忍度配置（允许的最大错误量）</span></span><br><span class="line">                <span class="attr">&quot;record&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span>  <span class="comment">// 允许的错误记录数上限：0表示不允许任何单条记录同步失败</span></span><br><span class="line">                <span class="attr">&quot;percentage&quot;</span><span class="punctuation">:</span> <span class="number">0.02</span>  <span class="comment">// 允许的错误率上限：0.02即2%，表示当错误记录数占总记录数的比例≤2%时任务可继续执行（实际生效规则为&quot;记录数上限&quot;和&quot;错误率&quot;取更宽松的条件，此处0条记录严格于2%，故实际以record=0为准）</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;content&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span>  <span class="comment">// 同步任务的具体内容（数据源和目标存储的配置），可包含多个同步子任务（数组形式）</span></span><br><span class="line">            <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;reader&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span>  <span class="comment">// 数据读取插件配置（源端）</span></span><br><span class="line">                    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;mysqlreader&quot;</span><span class="punctuation">,</span>  <span class="comment">// 读取插件名称：使用mysqlreader从MySQL数据库读取数据</span></span><br><span class="line">                    <span class="attr">&quot;parameter&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span>  <span class="comment">// mysqlreader的具体参数配置</span></span><br><span class="line">                        <span class="attr">&quot;username&quot;</span><span class="punctuation">:</span> <span class="string">&quot;jd&quot;</span><span class="punctuation">,</span>  <span class="comment">// MySQL登录用户名</span></span><br><span class="line">                        <span class="attr">&quot;password&quot;</span><span class="punctuation">:</span> <span class="string">&quot;123456&quot;</span><span class="punctuation">,</span>  <span class="comment">// MySQL登录密码（生产环境建议加密存储，避免明文）</span></span><br><span class="line">                        <span class="attr">&quot;column&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span>  <span class="comment">// 需要读取的列名列表</span></span><br><span class="line">                            <span class="string">&quot;*&quot;</span>  <span class="comment">// &quot;*&quot;表示读取表中所有列（注意：需与writer的column配置的字段数量和顺序一致，否则会导致字段不匹配）</span></span><br><span class="line">                        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;connection&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span>  <span class="comment">// MySQL连接信息（可配置多个库表，数组形式）</span></span><br><span class="line">                            <span class="punctuation">&#123;</span></span><br><span class="line">                                <span class="attr">&quot;table&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span>  <span class="comment">// 要读取的表名列表</span></span><br><span class="line">                                    <span class="string">&quot;hwz_nmpa&quot;</span>  <span class="comment">// 目标表：从该表读取数据</span></span><br><span class="line">                                <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                                <span class="attr">&quot;jdbcUrl&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span>  <span class="comment">// MySQL的JDBC连接地址（可配置多个，用于分库分表场景）</span></span><br><span class="line">                                    <span class="string">&quot;jdbc:mysql://192.168.8.8:3306/jd&quot;</span>  <span class="comment">// 连接地址格式：jdbc:mysql://IP:端口/数据库名（此处数据库为jd）</span></span><br><span class="line">                                <span class="punctuation">]</span></span><br><span class="line">                            <span class="punctuation">&#125;</span></span><br><span class="line">                        <span class="punctuation">]</span></span><br><span class="line">                    <span class="punctuation">&#125;</span></span><br><span class="line">                <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;writer&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span>  <span class="comment">// 数据写入插件配置（目标端）</span></span><br><span class="line">                    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;hdfswriter&quot;</span><span class="punctuation">,</span>  <span class="comment">// 写入插件名称：使用hdfswriter将数据写入HDFS</span></span><br><span class="line">                    <span class="attr">&quot;parameter&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span>  <span class="comment">// hdfswriter的具体参数配置</span></span><br><span class="line">                        <span class="attr">&quot;defaultFS&quot;</span><span class="punctuation">:</span> <span class="string">&quot;hdfs://hdp:8020&quot;</span><span class="punctuation">,</span>  <span class="comment">// HDFS的NameNode地址：格式为hdfs://主机名/服务名:端口（此处hdp为主机名，8020为HDFS默认端口）</span></span><br><span class="line">                        <span class="attr">&quot;fileType&quot;</span><span class="punctuation">:</span> <span class="string">&quot;orc&quot;</span><span class="punctuation">,</span>  <span class="comment">// 输出文件格式：ORC格式（列式存储，压缩率高，适合大数据场景）</span></span><br><span class="line">                        <span class="attr">&quot;path&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/zhiyun/huangwenzhe/tmp/nmpa&quot;</span><span class="punctuation">,</span>  <span class="comment">// HDFS上的存储路径：数据将写入该目录下</span></span><br><span class="line">                        <span class="attr">&quot;fileName&quot;</span><span class="punctuation">:</span> <span class="string">&quot;nmpa.data&quot;</span><span class="punctuation">,</span>  <span class="comment">// 输出文件名前缀：实际生成的文件名为&quot;nmpa.data_随机后缀&quot;（因并行写入可能生成多个文件）</span></span><br><span class="line">                        <span class="attr">&quot;column&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span>  <span class="comment">// 写入HDFS的字段定义（需与reader读取的列一一对应，名称和类型需匹配）</span></span><br><span class="line">	                        <span class="comment">// 字段名，类型</span></span><br><span class="line">                            <span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;id&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;int&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span>  </span><br><span class="line">                            <span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;index_id&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span>  </span><br><span class="line">                            <span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;title&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span>  </span><br><span class="line">                            <span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;category&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span>  </span><br><span class="line">                            <span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;post_date&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span>  </span><br><span class="line">                            <span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;content&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span>  </span><br><span class="line">                            <span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;attachment_count&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;int&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span>  </span><br><span class="line">                            <span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;attachment_path&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span>  </span><br><span class="line">                            <span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;link&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span>  </span><br><span class="line">                            <span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;create_time&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span>  </span><br><span class="line">                            <span class="punctuation">&#123;</span><span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;update_time&quot;</span><span class="punctuation">,</span> <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;string&quot;</span><span class="punctuation">&#125;</span>   </span><br><span class="line">                        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;writeMode&quot;</span><span class="punctuation">:</span> <span class="string">&quot;truncate&quot;</span><span class="punctuation">,</span>  <span class="comment">// 写入模式：truncate表示先删除目标路径下的所有文件，再写入新数据（覆盖写）；可选值还有append（追加）、nonConflict（不冲突则写）</span></span><br><span class="line">                        <span class="attr">&quot;fieldDelimiter&quot;</span><span class="punctuation">:</span> <span class="string">&quot;\t&quot;</span>  <span class="comment">// 字段分隔符：因fileType为ORC（列式存储，内部不依赖分隔符），此参数实际生效有限，主要用于兼容文本格式（如txt/csv）的场景</span></span><br><span class="line">                    <span class="punctuation">&#125;</span></span><br><span class="line">                <span class="punctuation">&#125;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h1 id="抽取数据"><a href="#抽取数据" class="headerlink" title="抽取数据"></a>抽取数据</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 注意抽取前需要提前创建HDFS目录</span></span><br><span class="line">hadoop fs -<span class="built_in">mkdir</span> -p /zhiyun/huangwenzhe/tmp/nmpa</span><br></pre></td></tr></table></figure>
<p>在<a target="_blank" rel="noopener" href="http://192.168.8.67:9870/explorer.html#/zhiyun/huangwenzhe/tmp">Browsing HDFS</a>处验证</p>
<img src="/2025/07/31/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%AD%A6%E4%B9%A0/%E9%A1%B9%E7%9B%AE/7.31%20%E5%8C%BB%E8%8D%AF%E5%99%A8%E6%A2%B0%E6%B3%95%E8%A7%84AI%E9%A1%B9%E7%9B%AE%EF%BC%88%E6%95%B0%E6%8D%AE%E5%90%8C%E6%AD%A5%E9%83%A8%E5%88%86%EF%BC%89/file-20250731154222273.png" class="">
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 开始抽取</span></span><br><span class="line">python /opt/datax/bin/datax.py /zhiyun/huangwenzhe/jobs/nmpa.json</span><br></pre></td></tr></table></figure>
<p>在<a target="_blank" rel="noopener" href="http://192.168.8.67:9870/explorer.html#/zhiyun/huangwenzhe/tmp/nmpa">Browsing HDFS</a>处验证</p>
<img src="/2025/07/31/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%AD%A6%E4%B9%A0/%E9%A1%B9%E7%9B%AE/7.31%20%E5%8C%BB%E8%8D%AF%E5%99%A8%E6%A2%B0%E6%B3%95%E8%A7%84AI%E9%A1%B9%E7%9B%AE%EF%BC%88%E6%95%B0%E6%8D%AE%E5%90%8C%E6%AD%A5%E9%83%A8%E5%88%86%EF%BC%89/file-20250731154745544.png" class="">

<h1 id="Hive建表"><a href="#Hive建表" class="headerlink" title="Hive建表"></a>Hive建表</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 终端进入hive</span></span><br><span class="line">hive</span><br><span class="line"><span class="comment"># 执行以下sql语句（正确执行应显示ok）</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 建立ODS数据库</span></span><br><span class="line"><span class="keyword">create</span> database if <span class="keyword">not</span> <span class="keyword">exists</span> ods_huangwenzhe location &quot;/zhiyun/huangwenzhe/ods&quot;;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 建立NMPA分区表</span></span><br><span class="line"><span class="comment">-- ODS的表应该是外部表</span></span><br><span class="line"><span class="comment">-- 内部表删除表的时候删除数据，外部表删除表不删除数据</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">external</span> <span class="keyword">table</span> if <span class="keyword">not</span> <span class="keyword">exists</span> ods_huangwenzhe.nmpa(</span><br><span class="line">id <span class="type">int</span>,</span><br><span class="line">index_id string,</span><br><span class="line">title string,</span><br><span class="line">category string,</span><br><span class="line">post_date string,</span><br><span class="line">content string,</span><br><span class="line">attachment_count string,</span><br><span class="line">attachment_path string,</span><br><span class="line">link string,</span><br><span class="line">create_time string,</span><br><span class="line">update_time string</span><br><span class="line">) partitioned <span class="keyword">by</span> (dt string)</span><br><span class="line"><span class="type">row</span> format delimited fields terminated <span class="keyword">by</span> &quot;/t&quot;</span><br><span class="line">lines terminated <span class="keyword">by</span> &quot;\n&quot;</span><br><span class="line">stored <span class="keyword">as</span> orc</span><br><span class="line">location &quot;/zhiyun/huangwenzhe/ods/nmpa&quot;;</span><br></pre></td></tr></table></figure>

<p>查看表</p>
<img src="/2025/07/31/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%AD%A6%E4%B9%A0/%E9%A1%B9%E7%9B%AE/7.31%20%E5%8C%BB%E8%8D%AF%E5%99%A8%E6%A2%B0%E6%B3%95%E8%A7%84AI%E9%A1%B9%E7%9B%AE%EF%BC%88%E6%95%B0%E6%8D%AE%E5%90%8C%E6%AD%A5%E9%83%A8%E5%88%86%EF%BC%89/file-20250731161831503.png" class="">

<h1 id="加载数据到当月分区"><a href="#加载数据到当月分区" class="headerlink" title="加载数据到当月分区"></a>加载数据到当月分区</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">load data inpath <span class="string">&quot;/zhiyun/huangwenzhe/tmp/nmpa/*&quot;</span> overwrite into table ods_huangwenzhe.nmpa partition(dt=<span class="string">&quot;2025-07&quot;</span>);</span><br></pre></td></tr></table></figure>
<img src="/2025/07/31/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%AD%A6%E4%B9%A0/%E9%A1%B9%E7%9B%AE/7.31%20%E5%8C%BB%E8%8D%AF%E5%99%A8%E6%A2%B0%E6%B3%95%E8%A7%84AI%E9%A1%B9%E7%9B%AE%EF%BC%88%E6%95%B0%E6%8D%AE%E5%90%8C%E6%AD%A5%E9%83%A8%E5%88%86%EF%BC%89/file-20250731163303274.png" class="">
<h2 id="验证数据"><a href="#验证数据" class="headerlink" title="验证数据"></a>验证数据</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(<span class="number">1</span>) <span class="keyword">from</span> ods_huangwenzhe.nmpa;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> ods_huangwenzhe.nmpa limit <span class="number">1</span>;</span><br></pre></td></tr></table></figure>

<h1 id="自动化调度"><a href="#自动化调度" class="headerlink" title="自动化调度"></a>自动化调度</h1><p>需求：每天凌晨4点自动执行这个流程<br>调度平台：<a target="_blank" rel="noopener" href="http://192.168.8.67:12345/dolphinscheduler/ui/login">海豚调度平台</a><br>优势：告警机制（任务出错了需要通知）；自动重试<br>用户名&#x2F;密码：admin &#x2F; dolphinscheduler123</p>
<p>项目管理-创建项目-点击进入项目-工作流定义-创建工作流</p>
<img src="/2025/07/31/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%AD%A6%E4%B9%A0/%E9%A1%B9%E7%9B%AE/7.31%20%E5%8C%BB%E8%8D%AF%E5%99%A8%E6%A2%B0%E6%B3%95%E8%A7%84AI%E9%A1%B9%E7%9B%AE%EF%BC%88%E6%95%B0%E6%8D%AE%E5%90%8C%E6%AD%A5%E9%83%A8%E5%88%86%EF%BC%89/file-20250731204621169.png" class="">
<img src="/2025/07/31/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%AD%A6%E4%B9%A0/%E9%A1%B9%E7%9B%AE/7.31%20%E5%8C%BB%E8%8D%AF%E5%99%A8%E6%A2%B0%E6%B3%95%E8%A7%84AI%E9%A1%B9%E7%9B%AE%EF%BC%88%E6%95%B0%E6%8D%AE%E5%90%8C%E6%AD%A5%E9%83%A8%E5%88%86%EF%BC%89/file-20250731201838774.png" class="">

<p><strong>加载数据</strong>的shell脚本实现动态按月分区</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">current_month=$(<span class="built_in">date</span> +<span class="string">&quot;%Y-%m&quot;</span>) <span class="comment"># 先定义变量</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用hive -e执行，注意变量引用要用$current_month，且外层用双引号</span></span><br><span class="line">hive -e <span class="string">&quot;load data inpath &#x27;/zhiyun/laojiaen/tmp/yaozh/*&#x27; overwrite into table ods_laojiaen.yaozh partition(dt=&#x27;<span class="variable">$current_month</span>&#x27;);&quot;</span></span><br></pre></td></tr></table></figure>

<p>成功运行</p>
<img src="/2025/07/31/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%AD%A6%E4%B9%A0/%E9%A1%B9%E7%9B%AE/7.31%20%E5%8C%BB%E8%8D%AF%E5%99%A8%E6%A2%B0%E6%B3%95%E8%A7%84AI%E9%A1%B9%E7%9B%AE%EF%BC%88%E6%95%B0%E6%8D%AE%E5%90%8C%E6%AD%A5%E9%83%A8%E5%88%86%EF%BC%89/file-20250731204101663.png" class="">
<img src="/2025/07/31/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%AD%A6%E4%B9%A0/%E9%A1%B9%E7%9B%AE/7.31%20%E5%8C%BB%E8%8D%AF%E5%99%A8%E6%A2%B0%E6%B3%95%E8%A7%84AI%E9%A1%B9%E7%9B%AE%EF%BC%88%E6%95%B0%E6%8D%AE%E5%90%8C%E6%AD%A5%E9%83%A8%E5%88%86%EF%BC%89/file-20250731205749853.png" class=""></article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a></div><div class="post-share"><div class="social-share" data-image="/img/peppapig8.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/06/24/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%AD%A6%E4%B9%A0/Hadoop/6.24%20Hadoop%E9%83%A8%E7%BD%B2/" title="6.24 Hadoop部署"><img class="cover" src="/img/peppapig1.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-06-24</div><div class="info-item-2">6.24 Hadoop部署</div></div><div class="info-2"><div class="info-item-1">Hadoop简介 Hadoop是一个由Apache基金会所开发的分布式系统基础架构 主要解决，海量数据的存储和海量数据的分析计算问题 广义上来说，Hadoop通常是指一个更广泛的概念-Hadoop生态圈  分布式存储Hadoop 的分布式存储主要基于 HDFS（分布式文件系统）:HDFS将数据分割成多个数据块（block），这些数据块分散存储在集群中的不同节点上。每个数据块会有多个副本，通常默认是 3 个副本.采用分布式存储在不同的节点上，提高了数据的可靠性和容错性。 Hadoop的分布式核心组件是MapReduce编程模型:在MapReduce任务中，数据被切分为多个任务，每个任务由或多个节点并行。每个节点负责将输入数据映射为键-值对生成中间结果。最后，中间结果按照键的排序进行合并和归并。 Hadoop组件HDFSHDFS组件用于存储数据,主要由NameNode,DataNode,SecondaryNameNode 组成  NameNode (nn): 存储文件的元数据，如文件名，文件目录结构，文件属性 (生成时间、副本数、文件权限)，以及每个文件的块列表和块所在的DataNo...</div></div></div></a><a class="pagination-related" href="/2025/06/27/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%AD%A6%E4%B9%A0/Hadoop/6.27%20Hive%E5%A4%8D%E5%90%88%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E3%80%81%E7%9B%B8%E5%85%B3%E5%87%BD%E6%95%B0/" title="Hive复合数据类型、相关函数"><img class="cover" src="/img/peppapig7.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-06-27</div><div class="info-item-2">Hive复合数据类型、相关函数</div></div><div class="info-2"><div class="info-item-1">Hive复合数据类型通过以下三种复合类型，Hive 能够高效处理半结构化数据（如日志、JSON），避免频繁进行表连接操作 array 数组array&lt;value数据类型&gt;存储同类型元素的有序集合，元素通过索引访问（从 0 开始） 12345--查询复合数据select  a_score[0] from student2--构造复合数据-arrayselect array(值,值) from student struct 集合struct&lt;key值:value数据类型,key值:value数据类型&gt;存储不同类型字段的集合，每个字段有名称和类型，通过点号（.）访问 12345--查询复合数据select  s_score.chinese from student2--构造复合数据select named_struct(key,value,key,value) from student map 字典map&lt;key数据类型,value数据类型&gt;存储键值对（Key-Value）集合，键必须唯一，通过键访问值 12345--查询复合数据select  m_...</div></div></div></a><a class="pagination-related" href="/2025/06/30/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%AD%A6%E4%B9%A0/Hadoop/6.30%20Hive%E5%88%86%E5%8C%BA%E8%A1%A8%E3%80%81%E5%88%86%E6%A1%B6%E8%A1%A8/" title="Hive分区表、分桶表"><img class="cover" src="/img/peppapig3.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-06-30</div><div class="info-item-2">Hive分区表、分桶表</div></div><div class="info-2"><div class="info-item-1">分区表分区是将一个表或索引物理地分解为多个更小、更可管理的部分。分区对应用透明，即对访问数据库的应用而言，逻辑上讲只有一个表或一个索引（相当于应用“看到”的只是一个表或索引），但在物理上这个表或索引可能由数十个物理分区组成。 在 Hadoop 中，Hive 分区表通常以特定的目录结构来存储。每个分区对应一个独立的目录，目录名通常包含分区列的值。数据文件会存储在相应的分区目录下。 分桶表•分区提供一个隔离数据和优化查询的便利方式。不过，并非所有的数据集都可形成合理的分区。对于一张表或者分区，Hive 可以进一步组织成桶，也就是更为细粒度的数据范围划分。 •分桶是将数据集分解成更容易管理的若干部分的另一个技术。 •分区针对的是数据的存储路径；分桶针对的是数据文件。 分桶策略：Hive的分桶采用对分桶字段的值进行哈希，然后除以桶的个数求余的方 式决定该条记录存放在哪个桶当中。     分区表 分桶表    划分依据 分区列的离散值（目录分割） 分桶列的哈希值（文件分割）   数量灵活性 分区数量可动态新增 桶数量固定（创建时指定）   优化目标 减少扫描范围（过滤查询） 优化 Join...</div></div></div></a><a class="pagination-related" href="/2025/07/07/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%AD%A6%E4%B9%A0/Hadoop/7.7%20hadoop%E9%97%AE%E7%AD%94/" title="hadoop问答"><img class="cover" src="/img/peppapig4.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-07</div><div class="info-item-2">hadoop问答</div></div><div class="info-2"><div class="info-item-1">1. hadoop组件有哪些?分别有什么功能   组件 功能    HDFS 分布式文件存储系统，提供高容错性海量存储   MapReduce 分布式计算框架，并行处理大数据集   YARN 资源调度系统，管理集群资源并分配任务   Hive 主要用于处理结构化和半结构化数据   Common 通用工具库，支持其他模块   2. 分布式存储的组件是什么 ?有哪些进程? 进程的作用是什么?分布式存储组件是 HDFS，其包含的进程及作用如下：    进程 作用    NameNode 管理元数据（文件名、块位置、权限），响应客户端请求   DataNode 存储实际数据块，定期向NN发送心跳和块报告   SecondaryNameNode 定期合并FsImage和Edits日志（非热备，缓解NN压力）   3. 资源调度使用什么组件? 该组件有哪些进程?每个进程的作用是什么?资源调度使用的组件是 YARN，相关进程及作用如下：    进程 作用    ResourceManager 负责全局资源的调度和分配   NodeManager 管理单个节点上的资源和容器   Applicat...</div></div></div></a><a class="pagination-related" href="/2025/08/04/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%AD%A6%E4%B9%A0/%E9%A1%B9%E7%9B%AE/8.4%20%E6%95%B0%E6%8D%AE%E6%B8%85%E6%B4%97%E3%80%81%E5%90%88%E5%B9%B6%EF%BC%88SparkSQL%EF%BC%89/" title="医药项目：数据清洗、合并"><img class="cover" src="/img/peppapig5.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-08-04</div><div class="info-item-2">医药项目：数据清洗、合并</div></div><div class="info-2"><div class="info-item-1">SparkSQLSpark SQL 是 Apache Spark 生态系统中的一个核心模块，专门用于处理结构化数据。它为用户提供了使用 SQL 语句或 DataFrame API 来查询和操作数据的能力，极大地简化了大数据分析任务的开发流程。 一、Spark SQL 的核心特点 统一的数据访问方式Spark SQL 支持从多种数据源读取数据，包括：  JSON、Parquet、ORC、CSV 等文件格式 JDBC&#x2F;ODBC 接口连接传统数据库（如 MySQL、PostgreSQL） Hive 表（通过 HiveContext） Kafka 流数据（结合 Structured Streaming）   SQL 支持用户可以直接使用标准 SQL 查询数据，例如： 1SELECT name, age FROM people WHERE age &gt; 30 这使得熟悉 SQL 的数据分析师可以轻松上手。  DataFrame 和 Dataset APISpark SQL 提供了高层次的抽象：  DataFrame：以结构化方式组织的分布式数据集，类似于传统数据库中的表或 P...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/dbb.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Tetuka</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">67</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">33</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">1</div></a></div><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/H-Sanae/H-Sanae.github.io" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:1466753498@qq.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-text">服务器</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E7%BC%96%E5%86%99"><span class="toc-text">配置文件编写</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%8A%BD%E5%8F%96%E6%95%B0%E6%8D%AE"><span class="toc-text">抽取数据</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Hive%E5%BB%BA%E8%A1%A8"><span class="toc-text">Hive建表</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8A%A0%E8%BD%BD%E6%95%B0%E6%8D%AE%E5%88%B0%E5%BD%93%E6%9C%88%E5%88%86%E5%8C%BA"><span class="toc-text">加载数据到当月分区</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%AA%8C%E8%AF%81%E6%95%B0%E6%8D%AE"><span class="toc-text">验证数据</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%87%AA%E5%8A%A8%E5%8C%96%E8%B0%83%E5%BA%A6"><span class="toc-text">自动化调度</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/08/17/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%AD%A6%E4%B9%A0/%E5%85%B6%E4%BB%96%E6%9D%82%E9%A1%B9/%E4%BB%80%E4%B9%88%E6%98%AF%E4%B8%AD%E9%97%B4%E4%BB%B6/" title="什么是中间件"><img src="/img/peppapig1.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="什么是中间件"/></a><div class="content"><a class="title" href="/2025/08/17/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%AD%A6%E4%B9%A0/%E5%85%B6%E4%BB%96%E6%9D%82%E9%A1%B9/%E4%BB%80%E4%B9%88%E6%98%AF%E4%B8%AD%E9%97%B4%E4%BB%B6/" title="什么是中间件">什么是中间件</a><time datetime="2025-08-16T17:25:07.890Z" title="更新于 2025-08-17 01:25:07">2025-08-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/08/04/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%AD%A6%E4%B9%A0/%E9%A1%B9%E7%9B%AE/8.4%20%E6%95%B0%E6%8D%AE%E6%B8%85%E6%B4%97%E3%80%81%E5%90%88%E5%B9%B6%EF%BC%88SparkSQL%EF%BC%89/" title="医药项目：数据清洗、合并"><img src="/img/peppapig5.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="医药项目：数据清洗、合并"/></a><div class="content"><a class="title" href="/2025/08/04/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%AD%A6%E4%B9%A0/%E9%A1%B9%E7%9B%AE/8.4%20%E6%95%B0%E6%8D%AE%E6%B8%85%E6%B4%97%E3%80%81%E5%90%88%E5%B9%B6%EF%BC%88SparkSQL%EF%BC%89/" title="医药项目：数据清洗、合并">医药项目：数据清洗、合并</a><time datetime="2025-08-16T17:09:28.639Z" title="更新于 2025-08-17 01:09:28">2025-08-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/08/16/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%AD%A6%E4%B9%A0/Python/request%E5%92%8Cselenium%EF%BC%88Python%E7%88%AC%E8%99%AB%EF%BC%89/" title="request和selenium（Python爬虫）"><img src="/img/peppapig8.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="request和selenium（Python爬虫）"/></a><div class="content"><a class="title" href="/2025/08/16/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%AD%A6%E4%B9%A0/Python/request%E5%92%8Cselenium%EF%BC%88Python%E7%88%AC%E8%99%AB%EF%BC%89/" title="request和selenium（Python爬虫）">request和selenium（Python爬虫）</a><time datetime="2025-08-16T15:33:34.713Z" title="更新于 2025-08-16 23:33:34">2025-08-16</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/img/peppapig8.png);"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;2025 By Tetuka</span><span class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.4.0-b2</a></span></div><div class="footer_custom_text">感谢阅读</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"></div><script id="click-heart" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-heart.min.js" async="async" mobile="false"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="输入以搜索内容..." type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":false},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body></html>