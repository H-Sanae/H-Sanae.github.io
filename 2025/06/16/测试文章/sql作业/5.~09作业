-- 上机练习10

--1.查询工资比20号部门工资都大的员工信息
select * from emp where sal>(select max(sal) from emp where deptno=20)

--2.查询工资比20号部门工资任意一个大的员工信息
select * from emp where sal>(select min(sal) from emp where deptno=20)

--3.求最高工资员工的姓名
select ename from emp where sal=(select max(sal) from emp)

--4.查询员工工资和工作都和20号部门同时一样的员工信息
select * from emp where (sal,job) in(select sal,job from emp where deptno=20)

--5.查询部门平均工资大于整个公司平均工资的部门
select deptno from emp group by deptno having avg(sal)>(select avg(sal) from emp)

--6.求工资前五名的员工信息
select * from (
       select emp.*,dense_rank()over(order by sal desc) rnk from emp
) where rnk<=5

--7.查询emp表中所有数据的第2条到第5条
select * from(
       select emp.*,row_number()over(order by rownum desc) rnk from emp
) where rnk between 2 and 5 

--8.求每个部门工资最高的员工信息
select * from emp where (deptno,sal) in(
       select deptno,max(sal) from emp group by deptno
)

-- 上机练习11

--1.查询所有员工的名字和部门名称
select ename,dname from emp,dept where emp.deptno=dept.deptno
select ename,dname from emp inner join dept on emp.deptno=dept.deptno

--2.查询所有部门名称及部门的所有员工列表
select listagg(dname,'、') within group(order by dname) from emp inner join dept on emp.deptno=dept.deptno

--3.求所有员工姓名,工资和其领导的姓名,工资


4.求所有员工工资大于其领导工资的员工姓名和其上级领导姓名，上级领导工资及员工工资
5.在上题的基础上查询员工所对应的部门
6.查询出不是领导的员工
7.查询出每个员工编号，姓名，部门名称，工资等级和他的上级领导的姓名，工资等级
